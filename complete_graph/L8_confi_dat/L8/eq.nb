(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11592,        291]
NotebookOptionsPosition[     10886,        272]
NotebookOutlinePosition[     11359,        290]
CellTagsIndexPosition[     11316,        287]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"results", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellLabel->"In[22]:=",ExpressionUUID->"8f3e499f-d567-4edc-a782-918224601f07"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cMax", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mRange", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"2", ",", "cMax"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nRange", "=", 
    RowBox[{"Range", "[", 
     RowBox[{"1", ",", "CMax"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"Monitor", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"fileName", "=", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"\"\</home/statphys/eqs_dat/L8-m\>\"", ",", 
           RowBox[{"ToString", "[", "m", "]"}], ",", "\"\<-n\>\"", ",", 
           RowBox[{"ToString", "[", "n", "]"}], ",", "\"\<-eqs.dat\>\""}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FileExistsQ", "[", "fileName", "]"}], ",", 
          RowBox[{
           RowBox[{"eqs", "=", 
            RowBox[{"Import", "[", 
             RowBox[{"fileName", ",", "\"\<Text\>\""}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"f", "=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "+", "n"}], ")"}], "^", "2"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rn", "[", "j_", "]"}], ":=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"j", "/", 
                RowBox[{"(", 
                 RowBox[{"n", "+", "1"}], ")"}]}]}], ")"}], "*", 
             "\[ImaginaryI]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rp", "[", "j_", "]"}], ":=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "-", "1"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"n", "+", "1"}], ")"}]}]}], ")"}], "*", 
             "\[ImaginaryI]"}]}], " ", ";", "\n", "\t", 
           RowBox[{
            RowBox[{"qn", "[", "j_", "]"}], ":=", 
            RowBox[{"1", "-", 
             RowBox[{"j", "/", "m"}]}]}], " ", ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"qp", "[", "j_", "]"}], ":=", 
            RowBox[{"1", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", "-", "1"}], ")"}], "/", "m"}]}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"T12", "[", "h_", "]"}], ":=", 
            RowBox[{"h", "/", "f"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"T13", "[", "k_", "]"}], ":=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "k"}], ")"}], "/", "f"}]}], ";", 
           "\[IndentingNewLine]", " ", 
           RowBox[{
            RowBox[{"T21", "[", "h_", "]"}], ":=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "-", "h", "-", "1"}], ")"}], "/", "f"}]}], ";", 
           "\[IndentingNewLine]", " ", 
           RowBox[{
            RowBox[{"T23", "[", "k_", "]"}], ":=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "k"}], ")"}], "/", "f"}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"T31", "[", "h_", "]"}], ":=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "-", "h", "-", "1"}], ")"}], "/", "f"}]}], " ", 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"T32", "[", "k_", "]"}], ":=", 
            RowBox[{"k", "/", "f"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Om", "[", "k_", "]"}], ":=", 
            RowBox[{"k", "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "k"}], ")"}], "/", "f"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Op", "[", 
             RowBox[{"k_", ",", "h_"}], "]"}], ":=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "k"}], ")"}], "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"k", "+", "m", "-", "h"}], ")"}], "/", "f"}]}]}], " ", 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"wm", "[", "k_", "]"}], ":=", 
            RowBox[{"k", "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"n", "-", "k", "+", "1"}], ")"}], "/", "f"}]}]}], " ", 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"wp", "[", 
             RowBox[{"k_", ",", "h_"}], "]"}], ":=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"n", "-", "k"}], ")"}], "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"k", "+", "m", "-", "h", "-", "1"}], ")"}], "/", 
              "f"}]}]}], " ", ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Zm", "[", "h_", "]"}], ":=", 
            RowBox[{"h", "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "-", "h"}], ")"}], "/", "f"}]}]}], " ", ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Zp", "[", 
             RowBox[{"k_", ",", "h_"}], "]"}], ":=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "-", "h", "-", "1"}], ")"}], "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"h", "+", "n", "-", "k"}], ")"}], "/", "f"}]}]}], " ", 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Xm", "[", "h_", "]"}], ":=", 
            RowBox[{"h", "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"m", "-", "h", "-", "1"}], ")"}], "/", "f"}]}]}], " ", 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Xp", "[", 
             RowBox[{"k_", ",", "h_"}], "]"}], ":=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"m", "-", "h", "-", "1"}], ")"}], "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"h", "+", "n", "-", "k", "+", "1"}], ")"}], "/", 
              "f"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"solution", "=", 
            RowBox[{"ToExpression", "[", "eqs", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"targetVariable", "=", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<q1\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"n", "-", "1"}], "]"}], "<>", "\"\<0\>\""}], "]"}]}], 
           ";", "\n", "\t", 
           RowBox[{"targetValue", "=", 
            RowBox[{"targetVariable", "/.", " ", "solution"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"results", ",", 
             RowBox[{"{", 
              RowBox[{"m", ",", "n", ",", "targetValue"}], "}"}]}], "]"}]}]}],
          "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"m", ",", "mRange"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "nRange"}], "}"}]}], "]"}], ";"}], ",", 
    RowBox[{"ProgressIndicator", "[", 
     RowBox[{"m", ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "cMax"}], "}"}]}], "]"}]}], "]"}], 
  "\n"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.941836978241702*^9, 3.94183697824207*^9}, {
   3.941837013083028*^9, 3.9418370295077*^9}, 3.941837816288748*^9, {
   3.941837852181329*^9, 3.9418379929588957`*^9}, {3.941838083063057*^9, 
   3.9418380854580317`*^9}, {3.9418382121828547`*^9, 3.94183821294527*^9}, {
   3.941841780565053*^9, 3.941841781915114*^9}, 3.941841891975543*^9, {
   3.941842004299096*^9, 3.941842004687757*^9}, {3.941842282337085*^9, 
   3.941842340213025*^9}, {3.941842499190548*^9, 3.9418425036690397`*^9}, {
   3.9418426845036182`*^9, 3.941842760739008*^9}, {3.9418428341046953`*^9, 
   3.941842836744211*^9}, {3.941842894294787*^9, 3.941842900385729*^9}, {
   3.9418429479734592`*^9, 3.941843037802487*^9}, {3.941843194024975*^9, 
   3.941843222271185*^9}, {3.941843339712097*^9, 3.9418433885018587`*^9}, {
   3.941843452412489*^9, 3.941843495104192*^9}, {3.9418435804007883`*^9, 
   3.941843626171226*^9}, {3.941843689091981*^9, 3.9418437923063993`*^9}, {
   3.941843826909442*^9, 3.941843841296481*^9}, {3.9418438738060837`*^9, 
   3.9418438741934757`*^9}, {3.9418439412793217`*^9, 3.941843943215839*^9}, 
   3.941844367848827*^9, {3.941844719583538*^9, 3.941844758049795*^9}, {
   3.941845637455227*^9, 3.941845731487411*^9}, {3.941845786112602*^9, 
   3.941845786394973*^9}, {3.94184722285818*^9, 3.941847233943981*^9}, {
   3.941847274746668*^9, 3.94184736876268*^9}, {3.9418474180523653`*^9, 
   3.9418474487257967`*^9}, {3.941847516082444*^9, 3.941847551930256*^9}, {
   3.9418476920882597`*^9, 3.9418476947454576`*^9}, {3.941849512494233*^9, 
   3.94184951272757*^9}, {3.9418496578994837`*^9, 3.9418497384051332`*^9}, 
   3.9418499104424057`*^9, {3.9418522098323507`*^9, 
   3.941852225821761*^9}},ExpressionUUID->"531f8dc3-4425-43cb-b168-\
5e28f787a8f1"],

Cell[BoxData[{"results", "\n", 
 RowBox[{
  RowBox[{"outputFile", "=", "\"\</home/statphys/L8-p-r-result.txt\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"outputFile", ",", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"StringRiffle", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringJoin", "[", 
           RowBox[{"Riffle", "[", 
            RowBox[{
             RowBox[{"ToString", "/@", "#"}], ",", "\"\<,\>\""}], "]"}], 
           "]"}], "&"}], ",", "results"}], "]"}], ",", "\"\<\\n\>\""}], "]"}],
      "]"}], ",", "\"\<Text\>\""}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.941844388745481*^9, {3.9418444625265303`*^9, 
   3.941844463680275*^9}},ExpressionUUID->"caeaaa44-66da-4151-8295-\
d478d2249306"],

Cell[BoxData["results"], "Input",
 CellLabel->"",ExpressionUUID->"8f1cbcf5-9f79-4e8a-9a92-6ec880f713be"]
},
WindowSize->{1438.5, 763.5},
WindowMargins->{{0.75, Automatic}, {0.75, Automatic}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>1. Inherited,
FrontEndVersion->"13.0 for Linux x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1c89b8d0-b1c1-409e-9206-e4a6bf5716ba"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 171, 4, 29, "Input",ExpressionUUID->"8f3e499f-d567-4edc-a782-918224601f07"],
Cell[732, 26, 9216, 217, 744, "Input",ExpressionUUID->"531f8dc3-4425-43cb-b168-5e28f787a8f1"],
Cell[9951, 245, 824, 22, 71, "Input",ExpressionUUID->"caeaaa44-66da-4151-8295-d478d2249306"],
Cell[10778, 269, 104, 1, 29, "Input",ExpressionUUID->"8f1cbcf5-9f79-4e8a-9a92-6ec880f713be"]
}
]
*)

